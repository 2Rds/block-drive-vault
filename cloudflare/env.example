# =====================================================
# BlockDrive Cloudflare Environment Variables
# =====================================================
# Copy this file to .env and fill in the values
# See cloudflare/README.md for setup instructions
# =====================================================

# ---------------------------------
# Cloudflare Account Configuration
# ---------------------------------

# Your Cloudflare Account ID (found in dashboard URL or sidebar)
CLOUDFLARE_ACCOUNT_ID=your-account-id

# API Token with Workers, R2, and Zero Trust permissions
# Create at: https://dash.cloudflare.com/profile/api-tokens
# Required permissions:
#   - Workers Scripts: Edit
#   - Workers KV Storage: Edit
#   - Workers R2 Storage: Edit
#   - Access: Apps and Policies: Edit
CLOUDFLARE_API_TOKEN=your-api-token

# Zone ID for your domain (found in domain overview)
CLOUDFLARE_ZONE_ID=your-zone-id

# ---------------------------------
# Cloudflare R2 Storage
# ---------------------------------

# R2 bucket name (create in Cloudflare dashboard)
R2_BUCKET_NAME=blockdrive-storage

# R2 Access Key ID (create in R2 settings)
R2_ACCESS_KEY_ID=your-r2-access-key-id

# R2 Secret Access Key
R2_SECRET_ACCESS_KEY=your-r2-secret-access-key

# R2 S3-compatible endpoint
R2_ENDPOINT=https://${CLOUDFLARE_ACCOUNT_ID}.r2.cloudflarestorage.com

# R2 public access domain (optional, for public files)
R2_PUBLIC_DOMAIN=storage.blockdrive.io

# ---------------------------------
# Cloudflare Workers
# ---------------------------------

# Workers route pattern
WORKERS_ROUTE=api.blockdrive.io/*

# KV Namespace ID for rate limiting
KV_RATE_LIMITS_ID=your-kv-namespace-id

# Durable Objects namespace (for encryption sessions)
DO_ENCRYPTION_SESSIONS_ID=your-do-namespace-id

# ---------------------------------
# Zero Trust / Access
# ---------------------------------

# Zero Trust team name (organization name in Access)
ZERO_TRUST_TEAM_NAME=blockdrive

# Clerk OIDC Configuration
CLERK_OIDC_CLIENT_ID=your-clerk-client-id
CLERK_OIDC_CLIENT_SECRET=your-clerk-secret

# Clerk issuer URL
CLERK_ISSUER_URL=https://good-squirrel-87.clerk.accounts.dev/

# ---------------------------------
# IPFS Gateway
# ---------------------------------

# Cloudflare IPFS Gateway URL
CLOUDFLARE_IPFS_GATEWAY=https://cloudflare-ipfs.com

# Enable Cloudflare IPFS gateway for downloads (true/false)
USE_CLOUDFLARE_IPFS=true

# Filebase gateway (fallback)
FILEBASE_GATEWAY=https://ipfs.filebase.io

# ---------------------------------
# API Gateway Settings
# ---------------------------------

# Supabase URL (for forwarding requests)
SUPABASE_URL=https://your-project.supabase.co

# Allowed CORS origins (comma-separated)
ALLOWED_ORIGINS=https://blockdrive.io,https://app.blockdrive.io,http://localhost:5173

# Rate limit settings
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_BURST=150

# ---------------------------------
# WAF Settings
# ---------------------------------

# Enable managed OWASP ruleset
WAF_OWASP_ENABLED=true
WAF_OWASP_PARANOIA_LEVEL=2

# Enable Cloudflare managed rules
WAF_MANAGED_RULES_ENABLED=true

# Block requests from specific countries (comma-separated ISO codes)
# Leave empty to allow all countries
WAF_GEO_BLOCK_COUNTRIES=

# Challenge Tor exit nodes (true/false)
WAF_CHALLENGE_TOR=true

# ---------------------------------
# Monitoring & Logging
# ---------------------------------

# Enable Workers analytics
WORKERS_ANALYTICS_ENABLED=true

# Log level (debug, info, warn, error)
LOG_LEVEL=info

# Sentry DSN for error tracking (optional)
SENTRY_DSN=

# ---------------------------------
# Development Settings
# ---------------------------------

# Enable local development mode
# When true, uses wrangler dev instead of deployed Workers
LOCAL_DEV=false

# Local development port for Workers
WRANGLER_DEV_PORT=8787

# Skip SSL verification in development (never enable in production)
SKIP_SSL_VERIFY=false
